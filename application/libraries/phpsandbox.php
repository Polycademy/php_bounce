<?php defined('BASEPATH') OR exit('No direct script access allowed');/*** Sandbox environment for evaluating php*/class PHPsandbox{	private $session_workaround = false;	private $session_id = false;		private $error_array = array();	private $options = 	array(	'chroot' => '/', 								'display_errors' => 'off',								'pass_post' => false, 								'pass_get' => false, 								'pass_session_data' => false,								'pass_session_id' => false,								'auto_prepend_file' => false,								'auto_append_file' => false, 								'force_session_workaround' => true,								'max_execution_time' => 1, 								'memory_limit' => '2M', 								'disable_functions' => 'exec,passthru,shell_exec,system,proc_open,popen,curl_exec,curl_multi_exec,parse_ini_file,show_source,pcntl_fork,pcntl_exec,session_start,phpinfo,ini_set,include,require,include_once,require_once',								'safe_mode' => true,								'directory_protection' => true,								'directory_protection_allow_tmp' => true,								'use_apc' => false,								'log_to_file' => false,								'log_to_array' => true,								);		private $cli_options = '';	private $cli_command = 'php';		private $run_start_time = 0;	private $run_end_time = 0;		private $pre_fix_php = 'date_default_timezone_set("UTC");$i = 1;unset($argv[0]);while ($i < 3 && isset($argv[$i])){if(substr($argv[$i], 0, 5) == "_POST"){$_POST = unserialize(substr($argv[$i], 6));unset($argv[$i]);}else if(substr($argv[$i], 0, 4) == "_GET"){$_GET = unserialize(substr($argv[$i], 5));unset($argv[$i]);break;}$i++;}foreach($_ENV as $key => $value){putenv("$key=null");$_ENV[$key]=null;unset($_ENV[$key]);};echo"PREFIXED!";';		/**	 * 	 * PHP Sandbox default construct	 * 	 * Current options are: display_errors => on|off, disable_functions => (csv of functions), pass_post => true|flase, pass_get => true|flase, pass_session => true|flase, max_execution_time => seconds, memory_limit => 2M	 * 	 * @param array $options	 */	public function __construct($options = array()){			//this is the temporary directory of PHP		$this->options['chroot'] = sys_get_temp_dir();						$this->options['auto_prepend_file'] = realpath(dirname(__FILE__)).DIRECTORY_SEPARATOR.'phpsandbox-prepend.php';		$this->options['auto_append_file'] = realpath(dirname(__FILE__)).DIRECTORY_SEPARATOR.'phpsandbox-append.php';		$this->options = array_merge($this->options, $options);				if(isset($this->options['pass_session_id']) && $this->options['pass_session_id'] && isset($this->options['pass_session_data']) && $this->options['pass_session_data']){			$this->enableFunction('session_start', false);		}				$this->tempPath = sys_get_temp_dir().DIRECTORY_SEPARATOR;				if(PHP_VERSION >= 5.4){			$this->options['safe_mode'] = false;		}				$this->sessionWorkaround();				$this->buildCLIOptions();	}}